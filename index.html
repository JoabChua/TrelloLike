<!DOCTYPE html>
<html lang="en">
<head>
    <link rel="stylesheet" href="./public/index.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Maltem Test</title>
</head>
<body>
    <ul>
        <li><a class="active" href="#">Maltem</a></li>
        <li style="float:right;"><a href="#">Trello-Like</a></li>
    </ul>

    <button id="modalBtn" class="button" style="visibility:hidden;font-size: 0px;">click here</button>

    <div class="modal" id="createModal">
        <div class="modal-content">
            <div class="modal-header">
                <span class="closeBtn">&times;</span>
                <h4>Add New Card</h4>
            </div>
            <div class="modal-body">
                <p>Title (Required)</p>
                <input type="text" placeholder="Card Title" class="input-text" id="newCardTitle">
                <br>
                <p>Description (optional)</p>
                <textarea name="desc" id="newCardDesc" class="input-text" rows="5" placeholder="Describe the card information."></textarea>
            </div>
            <br>
            <div class="modal-footer">
                <button class="buttonCreate" onclick="newCard()">Create</button>
                <button class="buttonCancel" onclick="closeModal()">Cancel</button>
            </div>
        </div>
    </div>

    <div class="modal" id="editModal">
        <div class="modal-content">
            <div class="modal-header">
                <span class="closeBtn2">&times;</span>
                <h4>Edit Card</h4>
            </div>
            <div class="modal-body">
                <p>Title (Required)</p>
                <input type="text" placeholder="Card Title" class="input-text" id="editCardTitle">
                <br>
                <p>Description (optional)</p>
                <textarea name="desc" id="editCardDesc" class="input-text" rows="5" placeholder="Describe the card information."></textarea>
            </div>
            <br>
            <div class="modal-footer">
                <button class="buttonCreate" onclick="editCard()">Update</button>
                <button class="buttonCancel" onclick="closeModal()">Cancel</button>
            </div>
        </div>
    </div>

    <br> 
    <div class="canvas">
        <div class="board" id="board">  
        </div>
    </div>
    
</body>


<script src="./public//main.js"></script>
<script>
    var col = [];
    var cards = [];
    var dragDiff;
    var dropDiff;
    var cardShift = {};
    var finalCol;
    var cardId;

    window.onload = function startup() {
        alertSize();
        getJSONCol();
    }

    function setColCards(){
        var fullView = [];
        var embedView = [];
        for (var i = 0; i < col.length; i++){
            embedView[i] = "";
            fullView[i] = `
            <div class="list-wrapper" ondrop="drop(event)" ondragover="allowDrop(event)">
                <h3><strong>${col[i].title}</strong>
                <button class="btn" style="float:right;" onclick="deleteCol(${col[i].id})"><i class="fa fa-trash"></i></button>
                <button class="btn" style="float:right;" onclick="editCol(${col[i].id})"><i class="fa fa-edit"></i></button>    
                    </h3>
                <div class="list-cards" id="${col[i].id}">
                </div>
                <h3 style="cursor:pointer;" id="modalBtn" onclick="openModal(${col[i].id})">
                <strong>+ Add another card</strong></h3>
            </div>
                `;
            for (var j=0; j<cards.length; j++){
                if(cards[j].columnId == col[i].id){
                    if(embedView[i] == undefined){
                        embedView[i] = "";
                    }
                    embedView[i] += `
                        <div class="card" draggable="true" ondragstart="drag(event,${cards[j].id})" id="card${cards[j].id}">
                            <div class="container">
                                <h4 class="card-title"><b>${cards[j].title}</b>
                                <button class="btn" style="float:right;" onclick="deleteCard(${cards[j].id})"><i class="fa fa-trash"></i></button>
                                <button class="btn" style="float:right;" onclick="openEditModal(${cards[j].id})"><i class="fa fa-edit"></i></button> 
                                </h4>
                                <div class="card-content">
                                    <p>${cards[j].description}</p>
                                </div>
                            </div>
                        </div>
                    ` ;
                }
            }
        }
        setTimeout(() => {
            for (var i = 0; i < col.length; i++){
                document.getElementById(col[i].id).innerHTML = embedView[i];
            }
            dropdownContent();
        }, 10);
        document.getElementById("board").innerHTML = fullView;
        document.getElementById("board").innerHTML += `
        <div class="list-wrapper" style="cursor:pointer;">
            <h3 onclick="toggleInput()"><strong>Add another list</strong><a type="button" style="float:right;padding-right:10px;">+</a></h3>
            <div id="togggleList" style="display:none;">
                <input id="newlist" type="text" placeholder="List name" onkeypress="return newList(event)">
                <button class="addBtn" onclick="newList(event);">Add List</button>
            </div>
        </div>
        `;
    }
</script>
</html>